<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="apppasteleriav04.Views.Profile.Admin.AdminDashboardPage"
             Title="Dashboard Administrador"
             BackgroundColor="{StaticResource PageBackgroundColor}">

    <ScrollView>
        <VerticalStackLayout Padding="16" Spacing="16">
            
            <!-- Header -->
            <Label Text="Dashboard Administrador" 
                   FontSize="24" 
                   FontAttributes="Bold"
                   TextColor="{StaticResource HeaderTitleTextColor}"/>

            <!-- Métricas principales -->
            <Grid ColumnDefinitions="*,*,*" ColumnSpacing="8">
                
                <!-- Ventas de Hoy -->
                <Frame Grid.Column="0" 
                       BackgroundColor="{StaticResource CardBackgroundColor}"
                       CornerRadius="10"
                       Padding="12">
                    <VerticalStackLayout Spacing="4">
                        <Label Text="Ventas Hoy" 
                               FontSize="12" 
                               TextColor="{StaticResource SecondaryTextColor}"/>
                        <Label x:Name="TodaySalesLabel" 
                               Text="$0.00" 
                               FontSize="20" 
                               FontAttributes="Bold"
                               TextColor="{StaticResource PrimaryColor}"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- Pedidos de Hoy -->
                <Frame Grid.Column="1" 
                       BackgroundColor="{StaticResource CardBackgroundColor}"
                       CornerRadius="10"
                       Padding="12">
                    <VerticalStackLayout Spacing="4">
                        <Label Text="Pedidos Hoy" 
                               FontSize="12" 
                               TextColor="{StaticResource SecondaryTextColor}"/>
                        <Label x:Name="TodayOrdersLabel" 
                               Text="0" 
                               FontSize="20" 
                               FontAttributes="Bold"
                               TextColor="{StaticResource PrimaryColor}"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- Pedidos Pendientes -->
                <Frame Grid.Column="2" 
                       BackgroundColor="{StaticResource CardBackgroundColor}"
                       CornerRadius="10"
                       Padding="12">
                    <VerticalStackLayout Spacing="4">
                        <Label Text="Pendientes" 
                               FontSize="12" 
                               TextColor="{StaticResource SecondaryTextColor}"/>
                        <Label x:Name="PendingOrdersLabel" 
                               Text="0" 
                               FontSize="20" 
                               FontAttributes="Bold"
                               TextColor="Orange"/>
                    </VerticalStackLayout>
                </Frame>
            </Grid>

            <!-- Acceso rápido a funciones -->
            <Label Text="Acceso Rápido" 
                   FontSize="18" 
                   FontAttributes="Bold"
                   Margin="0,8,0,0"/>

            <Grid ColumnDefinitions="*,*" ColumnSpacing="8" RowSpacing="8">
                
                <Button Grid.Column="0" 
                        Text="Gestionar Productos"
                        Clicked="OnProductsClicked"
                        BackgroundColor="{StaticResource PrimaryColor}"
                        TextColor="White"
                        CornerRadius="8"/>

                <Button Grid.Column="1" 
                        Text="Ver Pedidos"
                        Clicked="OnOrdersClicked"
                        BackgroundColor="{StaticResource PrimaryColor}"
                        TextColor="White"
                        CornerRadius="8"/>

                <Button Grid.Column="0" Grid.Row="1"
                        Text="Analíticas"
                        Clicked="OnAnalyticsClicked"
                        BackgroundColor="{StaticResource PrimaryColor}"
                        TextColor="White"
                        CornerRadius="8"/>

                <Button Grid.Column="1" Grid.Row="1"
                        Text="Promociones"
                        Clicked="OnPromotionsClicked"
                        BackgroundColor="{StaticResource PrimaryColor}"
                        TextColor="White"
                        CornerRadius="8"/>
            </Grid>

            <!-- Pedidos Recientes -->
            <Label Text="Pedidos Recientes" 
                   FontSize="18" 
                   FontAttributes="Bold"
                   Margin="0,8,0,0"/>

            <CollectionView x:Name="RecentOrdersCollection"
                            ItemsSource="{Binding RecentOrders}"
                            EmptyView="No hay pedidos recientes">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame Margin="0,4" 
                               Padding="12"
                               BackgroundColor="{StaticResource CardBackgroundColor}"
                               CornerRadius="8">
                            <Grid ColumnDefinitions="*,Auto">
                                <VerticalStackLayout Spacing="4">
                                    <Label Text="{Binding Id, StringFormat='Pedido #{0}'}" 
                                           FontSize="14" 
                                           FontAttributes="Bold"/>
                                    <Label Text="{Binding CreatedAt, StringFormat='{0:dd/MM/yyyy HH:mm}'}" 
                                           FontSize="12"
                                           TextColor="{StaticResource SecondaryTextColor}"/>
                                </VerticalStackLayout>
                                <VerticalStackLayout Grid.Column="1" 
                                                     HorizontalOptions="End"
                                                     Spacing="4">
                                    <Label Text="{Binding Total, StringFormat='${0:F2}'}" 
                                           FontSize="16" 
                                           FontAttributes="Bold"
                                           HorizontalOptions="End"/>
                                    <Label Text="{Binding Status}" 
                                           FontSize="12"
                                           HorizontalOptions="End"/>
                                </VerticalStackLayout>
                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- Loading Indicator -->
            <ActivityIndicator x:Name="LoadingIndicator" 
                               IsRunning="False" 
                               IsVisible="False"
                               Color="{StaticResource PrimaryColor}"/>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
