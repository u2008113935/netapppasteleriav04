<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="apppasteleriav04.Views.Profile.Employee.EmployeeOrdersPage"
             Title="GestiÃ³n de Pedidos">

    <Grid RowDefinitions="Auto,*">
        
        <!-- Filter Bar -->
        <Frame Grid.Row="0" 
               Padding="15" 
               BackgroundColor="#F5F5F5"
               CornerRadius="0">
            <HorizontalStackLayout Spacing="10" HorizontalOptions="Center">
                <Button Text="Todos" 
                        x:Name="BtnAllOrders"
                        Clicked="OnFilterClicked"
                        BackgroundColor="#FF6B9D"
                        TextColor="White"
                        CornerRadius="15"
                        Padding="15,5"/>
                <Button Text="Pendientes" 
                        x:Name="BtnPendingOrders"
                        Clicked="OnFilterClicked"
                        BackgroundColor="LightGray"
                        TextColor="Black"
                        CornerRadius="15"
                        Padding="15,5"/>
                <Button Text="En Proceso" 
                        x:Name="BtnInProgressOrders"
                        Clicked="OnFilterClicked"
                        BackgroundColor="LightGray"
                        TextColor="Black"
                        CornerRadius="15"
                        Padding="15,5"/>
                <Button Text="Listos" 
                        x:Name="BtnReadyOrders"
                        Clicked="OnFilterClicked"
                        BackgroundColor="LightGray"
                        TextColor="Black"
                        CornerRadius="15"
                        Padding="15,5"/>
            </HorizontalStackLayout>
        </Frame>

        <!-- Orders List with RefreshView -->
        <RefreshView Grid.Row="1" 
                     x:Name="RefreshOrders"
                     Refreshing="OnRefreshing">
            
            <CollectionView x:Name="OrdersCollectionView"
                            SelectionMode="Single"
                            SelectionChanged="OnOrderSelected">
                
                <CollectionView.EmptyView>
                    <VerticalStackLayout Padding="20" 
                                         VerticalOptions="Center"
                                         HorizontalOptions="Center">
                        <Label Text="ðŸ“‹" 
                               FontSize="48"
                               HorizontalOptions="Center"/>
                        <Label Text="No hay pedidos" 
                               FontSize="18"
                               TextColor="Gray"
                               HorizontalOptions="Center"
                               Margin="0,10,0,0"/>
                        <Label Text="Los pedidos aparecerÃ¡n aquÃ­ cuando estÃ©n disponibles" 
                               FontSize="14"
                               TextColor="Gray"
                               HorizontalOptions="Center"/>
                    </VerticalStackLayout>
                </CollectionView.EmptyView>

                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame Margin="10,5" 
                               Padding="15" 
                               CornerRadius="10"
                               BorderColor="#E0E0E0">
                            <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto,Auto,Auto" ColumnSpacing="10" RowSpacing="5">
                                
                                <!-- Order ID -->
                                <Label Grid.Column="0" Grid.Row="0"
                                       Text="{Binding Id, StringFormat='Pedido #{0:N}'}" 
                                       FontSize="16" 
                                       FontAttributes="Bold"/>
                                
                                <!-- Status Badge -->
                                <Frame Grid.Column="1" Grid.Row="0"
                                       Padding="8,4"
                                       CornerRadius="10"
                                       BackgroundColor="#FF9800">
                                    <Label Text="{Binding Status}" 
                                           FontSize="12"
                                           TextColor="White"
                                           FontAttributes="Bold"/>
                                </Frame>

                                <!-- Customer Info -->
                                <Label Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="1"
                                       Text="{Binding UserId, StringFormat='Cliente: {0}'}" 
                                       FontSize="14"
                                       TextColor="Gray"/>

                                <!-- Order Date -->
                                <Label Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="2"
                                       Text="{Binding CreatedAt, StringFormat='Fecha: {0:dd/MM/yyyy HH:mm}'}" 
                                       FontSize="14"
                                       TextColor="Gray"/>

                                <!-- Total -->
                                <Label Grid.Column="0" Grid.Row="3"
                                       Text="{Binding Total, StringFormat='Total: S/ {0:F2}'}" 
                                       FontSize="16"
                                       FontAttributes="Bold"
                                       TextColor="#FF6B9D"/>

                                <!-- Action Buttons -->
                                <HorizontalStackLayout Grid.Column="1" Grid.Row="3" Spacing="5">
                                    <Button Text="Ver" 
                                            FontSize="12"
                                            Padding="10,5"
                                            CornerRadius="5"
                                            BackgroundColor="#2196F3"
                                            TextColor="White"
                                            Clicked="OnViewOrderDetails"/>
                                    <Button Text="Actualizar" 
                                            FontSize="12"
                                            Padding="10,5"
                                            CornerRadius="5"
                                            BackgroundColor="#4CAF50"
                                            TextColor="White"
                                            Clicked="OnUpdateStatus"/>
                                </HorizontalStackLayout>

                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
            
        </RefreshView>

    </Grid>
    
</ContentPage>
